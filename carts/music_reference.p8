pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
--pico-8 music reference
--patreon.com/mboffin

--note: this cart is intended 
--to be run and the resulting 
--image used as a reference. 
--the code below isn't commented
--simply because its only
--purpose is to draw what is 
--shown when the cart is run.

function _init()
	poke(0x5f2d, 1)
	kbd_play={"z","s","x","d","c","v","g","b","h","n","j","m","q","2","w","3","e","r","5","t","6","y","7","u"}
	keys={"z","x","c","v","b","n","m","q","w","e","r","t","y","u"}
	keyshowcolors={2,2,8,8,9,9,9,9,9,10}
	keyshow={}
	for i=1,#keys do keyshow[i]=0 end
	sharps={"-","s","d","-","g","h","j","-","2","3","-","5","6","7"}
	sharpshowcolors={15,15,10,10,10,10,10,10,10,9}
	sharpshow={}
	for i=1,#sharps do sharpshow[i]=0 end
	notes={"c","d","e","f","g","a","b"}
	x,y=8,20 --keyboard position
	h=36     --keyboard height
	sh=20    --sharp key height
	kw=8     --key width
end

function _update()
	key=stat(31)
	for i=1,#kbd_play do
		if (key==kbd_play[i]) then
			for i=1,#keys do
				if (key==keys[i]) keyshow[i]=10
			end
			for i=1,#sharps do
				if (key==sharps[i]) sharpshow[i]=10
			end
			sfx(i)
		end
	end
end

function _draw()
	cls(1)
	
	print("keys➡️notes for sfx editor",13,4,9)
	
	for i=0,#keys-1 do
		rectfill(x+i*kw,y,x+(i+1)*kw,y+h,7)
		rect(x+i*kw,y,x+(i+1)*kw,y+h,0)
		if (keyshow[i+1]>0) then
			keycol=keyshowcolors[keyshow[i+1]]
			keyshow[i+1]-=1
		else
			keycol=0
		end
		print(keys[i+1],x+i*kw+3,y+h-7,keycol)
		
		if (sharpshow[i+1]>0) then
			sharpcol=sharpshowcolors[sharpshow[i+1]]
			sharpshow[i+1]-=1
		else
			sharpcol=7
		end
		if (sharps[i+1]!="-") then
			rectfill(x+i*kw-3,y,x+(i+1)*kw-5,y+sh,0)
			print(sharps[i+1],x+i*kw-1,y+sh-6,sharpcol)
		end

		print(notes[(i%#notes)+1],x+i*kw+3,y+h+3,12)
		if (sharps[i+1]!="-") then
			print("#",x+i*kw-1,y-7,12)
		end
	end
	
	staffx=8
	staffy=79
	
	for i=0,3 do
		rect(staffx,staffy+i*4,staffx+111,staffy+(i+1)*4,5)
	end
	spr(1,9,staffy-1,2,3)
	

	for i=0,#keys-1 do
		if (i%2==0 and (i<2 or i>#keys-4)) line(i*7+20,staffy+20-i*2,i*7+27,staffy+20-i*2,5)
		spr(3,i*7+22,staffy+14-i*2)
		
		print(notes[(i%#notes)+1],i*7+22,staffy+24-i*2,7)
	end

	print("sfx(num,chan,offset,notes)",6,113,7)
	print("       ,chan,offset,notes",6,113,12)
	print("music(num,fade_len,chan_mask)",6,119,7)	
	print("         ,fade_len,chan_mask",6,119,12)	
	print(stat(31),0,0,7)
end
__gfx__
00000000000007770000000000070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000007070000000000070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000077077000000000070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000770077000000000070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000770077000000000070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000770077000000007770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000770077000000077770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000077770000000007700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000007707000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000077007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000770077700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000770777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000770707007700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000770007007700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000770007007700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000077007077700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000007777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000077700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000007707000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000007777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
010400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000400000c0700c0700c0600c0500c0300c0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000400000d0700d0700d0600d0500d0300d0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000400000e0700e0700e0600e0500e0300e0100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010400000f0700f0700f0600f0500f0300f0100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010400001007010070100601005010030100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010400001107011070110601105011030110100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010400001207012070120601205012030120100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010400001307013070130601305013030130100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010400001407014070140601405014030140100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010400001507015070150601505015030150100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010400001607016070160601605016030160100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010400001707017070170601705017030170100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010400001807018070180601805018030180100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010400001907019070190601905019030190100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010400001a0701a0701a0601a0501a0301a0100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010400001b0701b0701b0601b0501b0301b0100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010400001c0701c0701c0601c0501c0301c0100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010400001d0701d0701d0601d0501d0301d0100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010400001e0701e0701e0601e0501e0301e0100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010400001f0701f0701f0601f0501f0301f0100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010400002007020070200602005020030200100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010400002107021070210602105021030210100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010400002207022070220602205022030220100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010400002307023070230602305023030230100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
